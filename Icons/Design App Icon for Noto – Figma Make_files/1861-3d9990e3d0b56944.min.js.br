"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="11b66d40-149a-5408-9398-d72cfa234a26")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[1861],{571861:(t,e,i)=>{i.d(e,{iX:()=>j});var s=i(104076),n=i(716976),o=i(99723),r=i(266808),a=i(812714),h=i(291705),l=i(466890),d=i(633065),p=i(795161),c=i(192075),g=i(58212),y=i(814082),u=i(130689),S=i(675477),f=i(443192),m=i(17057),C=i(944350),E=i(821359),k=i(977899),T=i(894210),M=i(116553),I=i(753703),v=i(484655),K=i(403206),x=i(683785),P=i(695370),w=i(479929),_=i(974528);let{hasCommandModifier:b}=h.KeyBindingUtil;var F=(t=>(t.Bold="toggle-bold",t.Italic="toggle-italic",t.Strikethrough="toggle-strikethrough",t))(F||{}),O=(t=>(t.UL="toggle-unordered-list",t.OL="toggle-ordered-list",t))(O||{}),H=(t=>(t.ListBackspace="handle-list-backspace",t.Undo="handle-undo",t.Redo="handle-redo",t.Link="toggle-link",t))(H||{});let L={BOLD:{fontWeight:600},HIGHLIGHT:{background:"var(--color-texthighlight)"}},U={"toggle-bold":"BOLD","toggle-italic":"ITALIC","toggle-strikethrough":"STRIKETHROUGH"},A={"toggle-unordered-list":"unordered-list-item","toggle-ordered-list":"ordered-list-item"},B=new Set(["HIGHLIGHT",...Object.values(U)]);function D(){let t=[{strategy:P.Er,component:t=>(0,s.jsx)("span",{className:_.lE,spellCheck:!1,children:t.children})},{strategy:P.f7,component:t=>(0,s.jsx)("span",{className:_.lE,spellCheck:!1,children:t.children})},{strategy:P.cL,component:t=>(0,s.jsx)("span",{className:_.Zg,spellCheck:!1,children:t.children})},{strategy:P.mi,component:t=>{let e="",i="";if(t.entityKey&&t.contentState){let s=t.contentState.getEntity(t.entityKey).getData();e=s.hyperlink,i=s.commentEditorType}return(0,s.jsx)("span",{className:_.JM,"data-tooltip":T.MW.HYPERLINK_POPUP,"data-tooltip-can-edit":!0,"data-tooltip-entity-key":t.entityKey,"data-tooltip-interactive":!0,"data-tooltip-precise":!0,"data-tooltip-show-above":!0,"data-tooltip-target-ref-key":i,"data-tooltip-type":T.Ib.SPECIAL,"data-tooltip-unconstrain-width":!0,"data-tooltip-url-string":e,spellCheck:!1,children:t.children})}},{strategy:P.DL,component:t=>{let e=(0,w.Vt)(t.decoratedText);if(1!==e.length)return(0,s.jsx)(s.Fragment,{children:t.children});let i=new URL(e[0].href).toString();return(0,s.jsx)("span",{className:_.JM,"data-testid":`implicit-hyperlink-${i}`,"data-tooltip":T.MW.HYPERLINK_POPUP,"data-tooltip-can-edit":!1,"data-tooltip-interactive":!0,"data-tooltip-precise":!0,"data-tooltip-show-above":!0,"data-tooltip-type":T.Ib.SPECIAL,"data-tooltip-unconstrain-width":!0,"data-tooltip-url-string":i,spellCheck:!1,children:t.children})}}];return new h.CompositeDecorator(t)}let R=RegExp(/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/,"i");class j extends n.Component{constructor(t){super(t),this.TEST_ONLY_mentionsSearchPending=null,this.pendingMentionsSearch=null,this.wrapperRef=n.createRef(),this.onChange=t=>{let e=this.state.editorState;this.setState({editorState:t});let i=e.getCurrentContent(),s=t.getCurrentContent(),n=e.getSelection(),o=t.getSelection();i!==s?this.onEditorContentChange(t):this.props.typeahead?.type==="mentions"?n.getAnchorKey()!==o.getAnchorKey()||n.getFocusKey()!==o.getFocusKey()?this.clearTypeahead("changed_selection_mentions_typeahead"):this.setState({editorState:h.EditorState.forceSelection(t,o)}):n!==o&&this.clearTypeahead("changed_selection")},this.onEditorContentChange=t=>{let e=(0,P.yN)(t);this.props.updateMessage([e,t]);let{search:i,type:s}=(0,P.TE)(t);null!=i?"MENTION"===s?this.onMentionSearchChange(i):"EMOJI"===s?this.onEmojiSearchChange(i):"COMPLETE_EMOJI"===s&&(this.clearTypeahead("completed_emoji_search"),this.insertEmojiFromString(i)):this.clearTypeahead("input_deleted")},this.hasTypeahead=()=>!!this.props.typeahead,this.insertMention=(t,e)=>{let i=(0,P.Gm)(this.state.editorState);this.state.contactsAnalytics?.trackResultClicked(i,e.index,e.mentions.length,t.id.startsWith("invite-")),(0,v.r)(i,e,!0);let s=(0,x.AO)(this.state.editorState,t);"profile_handle"in t&&this.props.dispatch((0,u.Hx)(t)),this.onChange(s)},this.insertEmoji=t=>{let e=(0,x.gG)(this.state.editorState,t);this.onChange(e)},this.insertSuggestion=t=>{let e=(0,x.Ed)(this.state.editorState,t.suggestedComments[t.index]);this.onChange(e)},this.insertFirstPendingUserInvite=t=>{if(t[0].user?.email){let e=(0,x.rv)(this.state.editorState,t[0]);this.onChange(e)}},this.insertEmojiFromString=t=>{let e=(0,x.Ly)(this.state.editorState,t);this.onChange(e)},this.onInsert=()=>{let t=this.props.typeahead;t&&"mentions"===t.type&&t.mentions[t.index]?this.insertMention(t.mentions[t.index],t):t&&"emojis"===t.type&&t.emojis[t.index]?this.insertEmoji(t.emojis[t.index]):t&&"suggestions"===t.type&&this.insertSuggestion(t)},this.assignEditorOnInsertClear=()=>{this.props.editorOnInsert(this.onInsert),this.props.editorOnClear(()=>this.clearTypeahead("editor_clear"))},this.newMentionsSearch=async t=>{this.pendingMentionsSearch&&this.pendingMentionsSearch.cancel(),this.pendingMentionsSearch=new K.qm;try{return{result:await (0,K.t8)((0,E.fG)(t,this.props.mentionables,!this.props.isProtoView&&this.props.figmaEditorType===C._Y.DESIGN),this.pendingMentionsSearch),canceled:!1}}catch(t){if(t instanceof K.cJ)return{result:null,canceled:!0};throw t}},this.onMentionSearchChange=(0,o.s)(async t=>{let e=this.newMentionsSearch(t);(0,p.Lg)()&&(this.TEST_ONLY_mentionsSearchPending=e);let{result:i,canceled:s}=await e;s||(i?(this.state.contactsAnalytics?.trackQueryResult(t,i?.mentions.length??0),this.props.dispatch(y.We(i))):this.props.dispatch(y.We({type:"mentions",mentions:[],index:0,maxMentions:0,search:t,query:t})),this.props.onUpdateTextArea(this.state.editorState))},300),this.onEmojiSearchChange=t=>{this.props.dispatch(y.We((0,E.oQ)(t))),this.props.onUpdateTextArea(this.state.editorState)},this.clearTypeahead=t=>{this.pendingMentionsSearch&&this.pendingMentionsSearch.cancel(),this.state.contactsAnalytics?.endSession(t),this.hasTypeahead()&&(this.props.typeahead?.type==="suggestions"?"editor_clear"===t?this.props.dispatch(y.UU({force:!0})):"changed_selection"!==t&&this.props.dispatch(y.We(null)):this.props.dispatch(y.We(null)))},this._handleBeforeInput=(t,e)=>{if(this.props.maxCommentLength&&e.getCurrentContent().getPlainText("").length>=this.props.maxCommentLength)return"handled";let i=(0,P.Wt)(e,t);if("ordered-list-item"===i||"unordered-list-item"===i)return e=(0,P.q7)(e,i),this.onChange(e),"handled";let s=(0,P.XM)(e,t);return s?(e=(0,P.oP)(e,t,s),this.onChange(e),"handled"):"not-handled"},this.selectAll=()=>{let t=this.state.editorState.getSelection(),e=this.state.editorState.getCurrentContent(),i=t.merge({anchorKey:e.getFirstBlock().getKey(),anchorOffset:0,focusOffset:e.getLastBlock().getText().length,focusKey:e.getLastBlock().getKey()});this.setState({editorState:h.EditorState.forceSelection(this.state.editorState,i)})},this.hasFocus=()=>this.state.editorState.getSelection().getHasFocus(),this.focus=(t=!0)=>{let e=this.state.editorState.getSelection();e.getHasFocus()?this.props.onFocus():t?setTimeout(()=>{this.props.moveFocusToStartOnMount?this.setState({editorState:(0,P.jM)(this.state.editorState)}):this.setState({editorState:h.EditorState.moveFocusToEnd(this.state.editorState)}),this.onFocus()},0):this.setState({editorState:h.EditorState.forceSelection(this.state.editorState,e)})},this.moveFocusBefore=()=>{let t=(0,P.d8)(this.state.editorState),e=this.state.editorState.getCurrentContent().getBlockBefore(t.getKey()),i=this.state.editorState.getSelection();if(e){let t=i.merge({anchorKey:e.getKey(),anchorOffset:e.getLength(),focusKey:e.getKey(),focusOffset:e.getLength()});this.setState({editorState:h.EditorState.forceSelection(this.state.editorState,t)})}},this.isAllSelected=()=>{let t=this.state.editorState;return t.isSelectionAtStartOfContent()&&t.isSelectionAtEndOfContent()},this.onNavigationKeyDown=t=>(t.stopPropagation(),this.hasTypeahead())?(t.preventDefault(),null):(0,h.getDefaultKeyBinding)(t),this.handleEscape=()=>{this.hasTypeahead()||this.props.isThreadCommentOverflowMenuOpen||this.props.editingComment&&"comment-editor-reply"===this.props.editorType||this.props.onCancel()},this.handleReturn=(t,e)=>{t.stopPropagation();let i=this.state.editorState.getCurrentContent().getPlainText(),s=/^\s+$/,n=!!i&&!s.test(i),o=e.getSelection(),r=e.getCurrentContent().getBlockForKey(o.getStartKey());if(this.hasTypeahead())return t.preventDefault(),"handled";if(n){if(t.altKey||t.metaKey)return t.preventDefault(),this.props.onSubmit(),"handled";if(t.shiftKey||t.ctrlKey){let t=(0,P.XM)(e,"\n");if(t){e=(0,P.oP)(e,"",t);let i=h.Modifier.splitBlock(e.getCurrentContent(),e.getSelection());return e=h.EditorState.push(e,i,"split-block"),this.onChange(e),"handled"}}else if(o.isCollapsed()&&["unordered-list-item","ordered-list-item"].includes(r.getType())){if(s.test(r.getText())){let t=h.Modifier.setBlockType(e.getCurrentContent(),o,"unstyled");e=h.EditorState.push(e,t,"change-block-type")}else{let t=h.Modifier.splitBlock(e.getCurrentContent(),o);e=h.EditorState.push(e,t,"split-block")}return this.onChange(e),"handled"}else if(this.props.submitOnEnter)return t.preventDefault(),this.props.onSubmit(),"handled"}return"not-handled"},this.handlePastedFiles=t=>(this.props.onFilePaste&&this.props.onFilePaste(t),"handled"),this.handlePastedText=(t,e,i)=>{if(!t)return"handled";let s=i.getSelection(),n=i.getCurrentContent();if(!(0,P.c9)(i)&&t.match(R)&&(0,w.$x)((0,M.xT)(t))){for(let t of(s.getIsBackward()&&(s=s.merge({anchorKey:s.getFocusKey(),anchorOffset:s.getFocusOffset(),focusKey:s.getAnchorKey(),focusOffset:s.getAnchorOffset(),isBackward:!1})),Object.values(U)))n=h.Modifier.removeInlineStyle(n,s,t);let e=(n=n.createEntity("HYPERLINK","MUTABLE",{hyperlink:t,commentEditorType:this.props.editorType})).getLastCreatedEntityKey(),o=h.Modifier.applyEntity(n,s,e);i=h.EditorState.push(i,o,"apply-entity");let r=s.merge({anchorOffset:s.getEndOffset(),anchorKey:s.getEndKey(),focusOffset:s.getEndOffset(),focusKey:s.getEndKey()});return i=h.EditorState.forceSelection(i,r),this.onChange(i),"handled"}if((0,a.k)().comments_html_paste&&e){let t=(0,P._S)(e),s=h.Modifier.replaceWithFragment(i.getCurrentContent(),i.getSelection(),t.getBlockMap()),n=h.EditorState.push(i,s,"insert-fragment");return this.onChange(n),"handled"}{let e=h.Modifier.replaceWithFragment(i.getCurrentContent(),i.getSelection(),h.ContentState.createFromText(t).getBlockMap()),s=h.EditorState.push(i,e,"insert-fragment");return this.onChange(s),"handled"}},this.onSubmitHyperlink=t=>{let e=this.state.editorState;if(this.state.hyperlinkState){let i=this.state.hyperlinkState.selectionToHyperlink,s=(0,M.xT)(t);if((0,w.$x)(s)){if(i.isCollapsed()){let t=e.getCurrentContent();t=h.Modifier.insertText(t,i,s),e=h.EditorState.push(e,t,"insert-characters");let n=i.getStartOffset();i=(0,P.Ji)(e,{start:n,end:n+s.length})}let t=e.getCurrentContent();for(let e of B)t=h.Modifier.removeInlineStyle(t,i,e);if(e=h.EditorState.push(e,t,"change-inline-style"),this.state.hyperlinkState.entityKey){t=t.replaceEntityData(this.state.hyperlinkState.entityKey,{hyperlink:s,commentEditorType:this.props.editorType});let n=h.Modifier.applyEntity(t,i,this.state.hyperlinkState.entityKey);e=h.EditorState.push(e,n,"apply-entity")}else{let n=(t=t.createEntity("HYPERLINK","MUTABLE",{hyperlink:s,commentEditorType:this.props.editorType})).getLastCreatedEntityKey(),o=h.Modifier.applyEntity(t,i,n);e=h.EditorState.push(e,o,"apply-entity")}}else{let t=e.getCurrentContent();t=h.Modifier.removeInlineStyle(t,i,"HIGHLIGHT"),e=h.EditorState.push(e,t,"change-inline-style"),this.props.dispatch(g.F.enqueue({message:(0,c.t)("hyperlink.invalid_link_plain")}))}this.onChange(e),this.setState({hyperlinkState:null})}},this.onFocus=()=>{if(this.assignEditorOnInsertClear(),this.props.setIsEditorFocused(!0),this.focus(!this.props.maintainSelectionOnFocus),this.state.hyperlinkState?.selectionToHyperlink&&!this.props.hyperlinkLocation){let t=this.state.editorState.getCurrentContent(),e=this.state.editorState;t=h.Modifier.removeInlineStyle(t,this.state.hyperlinkState.selectionToHyperlink,"HIGHLIGHT"),e=h.EditorState.push(e,t,"change-inline-style"),this.onChange(e),this.setState({hyperlinkState:null})}},this.onBlur=()=>{let{typeahead:t}=this.props;if(t&&"mentions"===t.type&&t.mentions[t.index]){this.state.contactsAnalytics?.endSession("input_blurred");let e=(0,P.Gm)(this.state.editorState);(0,v.r)(e,t,!1)}this.props.setIsEditorFocused(!1)},this.handleKeyCommand=(t,e)=>{if(U[t]){let i=U[t],s=h.RichUtils.toggleInlineStyle(e,i);if(s)return this.onChange(s),"handled"}else if(A[t]){let i=A[t],s=h.RichUtils.toggleBlockType(e,i);if(s)return this.onChange(s),"handled"}else if("handle-undo"===t){e=h.EditorState.undo(e);let t=(0,P.d8)(e).getText();for(let i of P.Bm)if(t.trim()===i||"1."===t.trim()){let i=t.length;e=h.EditorState.forceSelection(e,(0,P.Ji)(e,{start:i,end:i}))}return this.onChange(e),"handled"}else if("handle-redo"===t){let t=(0,P.d8)(e).getText();e=h.EditorState.redo(e);let i=(0,P.d8)(e).getText();for(let s of P.Bm)if(t.trim()===s||i.trim()===s){let t=i.length;return e=h.EditorState.forceSelection(e,(0,P.Ji)(e,{start:t,end:t})),this.onChange(e),"handled"}if("1."===t.trim()||"1."===i.trim()){let t=i.length;return e=h.EditorState.forceSelection(e,(0,P.Ji)(e,{start:t,end:t})),this.onChange(e),"handled"}return this.onChange(e),"handled"}else if("handle-list-backspace"===t){let t=h.Modifier.setBlockType(e.getCurrentContent(),e.getSelection(),"unstyled"),i=h.EditorState.push(e,t,"change-block-type");return this.onChange(i),"handled"}else if("toggle-link"===t){let{selection:t,entityKey:i}=(0,P.M1)(e);e=h.EditorState.forceSelection(e,t),this.onChange(e);let s=(0,P.L5)();if(s&&this.props.setHyperlinkLocation&&this.props.setHyperlinkEditorRef)return this.setHyperlinkEditorState(e,s,i),"handled"}return"not-handled"},this.getActiveHyperlinkForCurrentSelection=()=>this.state.hyperlinkState?.entityKey?this.state.editorState.getCurrentContent().getEntity(this.state.hyperlinkState.entityKey).getData().hyperlink:"",this.onRemoveHyperlink=()=>{if(this.state.hyperlinkState?.entityKey){let t=this.state.editorState,e=h.Modifier.applyEntity(this.state.editorState.getCurrentContent(),this.state.hyperlinkState.selectionToHyperlink,null);this.onChange(h.EditorState.push(t,e,"apply-entity"))}},this.keyBindingFn=t=>{if("Escape"===t.key&&!this.props.delegateEscapeHandling)return this.handleEscape(),null;if("Backspace"===t.key){let t=(0,P.d8)(this.state.editorState);if(("ordered-list-item"===t.getType()||"unordered-list-item"===t.getType())&&(0,P.wT)(this.state.editorState))return"handle-list-backspace"}if("ArrowUp"===t.key||"ArrowDown"===t.key||"ArrowLeft"===t.key||"ArrowRight"===t.key||"Tab"===t.key)return this.onNavigationKeyDown(t);if(b(t)){t.stopPropagation();let e=r.Ez5?.uiState().isUI3.getCopy()??!1,i="k"===t.key&&!e||t.shiftKey&&"u"===t.key&&e;if("z"===t.key&&!t.shiftKey)return"handle-undo";if("z"===t.key&&t.shiftKey)return"handle-redo";if("b"===t.key)return"toggle-bold";if("i"===t.key)return"toggle-italic";if(i)return"toggle-link";if(t.shiftKey&&"x"===t.key)return"toggle-strikethrough";if(t.shiftKey&&"8"===t.key)return"toggle-unordered-list";if(t.shiftKey&&"7"===t.key)return"toggle-ordered-list"}return t.stopPropagation(),(0,h.getDefaultKeyBinding)(t)},this.onMouseDown=t=>{t.stopPropagation()},this.onContextMenu=t=>{d.eD||t.stopPropagation()},this.addAriaHiddenToPlaceholder=()=>{let t=this.wrapperRef.current?.querySelector(".public-DraftEditorPlaceholder-root");t&&t.setAttribute("aria-hidden","true")};let e=(0,m.Ty)(t.currentOrgId??null,t.user??null,t.currentOrgUsers),i=(0,m.pP)(t.currentOrgId,t.openFileTeamId,e),s=t.openFileTeamId??null,l=null,S=D();l=this.props.messageMeta?(0,P.Aw)(this.props.messageMeta,S,this.props.editorType):h.EditorState.createEmpty(S),this.state={editorState:l,contactsAnalytics:new m.yO(m.I2,t.openFileKey,i,t.currentOrgId,s,"draftjs"),hyperlinkState:null}}async componentDidMount(){if(this.assignEditorOnInsertClear(),this.addAriaHiddenToPlaceholder(),this.props.mountInputFocused){let t=this.props.moveFocusToStartOnMount?(0,P.jM)(this.state.editorState):h.EditorState.moveFocusToEnd(this.state.editorState);if(this.props.setIsEditorFocused(!0),this.onChange(t),(!this.props.hasMentionedPendingUserInvite||!this.props.hasMentionedPendingUserInviteTwice)&&this.props.pendingUserInvites&&this.props.pendingUserInvites.length>0){if(1===this.props.pendingUserInvites.length)this.insertFirstPendingUserInvite(this.props.pendingUserInvites);else{let{result:e,canceled:i}=await this.newMentionsSearch("");i||setTimeout(()=>{this.props.dispatch(y.We(e)),this.onChange(t),this.props.onUpdateTextArea(this.state.editorState)},180)}}}this.props.editorRef&&this.props.editorType&&this.props.dispatch(S.pP({targetKey:this.props.editorType,targetRef:this.props.editorRef})),this.props.updateMessageOnMount&&this.onEditorContentChange(this.state.editorState)}componentDidCatch(t){"Node.removeChild: The node to be removed is not a child of this node"===t.message&&this.forceUpdate()}componentDidUpdate(t){this.addAriaHiddenToPlaceholder();let e=this.state.editorState;if(!(0,l.Wf)(this.props.messageMeta,t.messageMeta)){let t=(0,P.yN)(this.state.editorState);if(!(0,l.Wf)(t,this.props.messageMeta)){let t=D();e=(0,P.Aw)(this.props.messageMeta,t,this.props.editorType),e=this.state.editorState.getSelection().getHasFocus()?h.EditorState.moveFocusToEnd(e):h.EditorState.moveSelectionToEnd(e),this.onChange(e)}let i=this.props.pendingUserInvites?.length===1?e.getCurrentContent().getPlainText()===`${this.props.pendingUserInvites[0].user?.email} `:""===e.getCurrentContent().getPlainText();(!this.props.hasMentionedPendingUserInvite||!this.props.hasMentionedPendingUserInviteTwice)&&(this.props.pendingUserInvites?.length??0)>0&&this.props.user?.id&&!this.props.typeahead&&i&&setTimeout(async()=>{if(this.props.onUpdateTextArea(this.state.editorState),this.props.pendingUserInvites?.length===1)this.props.dispatch(y.We((0,I.tI)({index:-1,userId:this.props?.user?.id})));else{let t=await (0,E.fG)("",this.props.mentionables,!this.props.isProtoView&&this.props.figmaEditorType===C._Y.DESIGN);this.props.dispatch(y.We(t))}},180)}if(t.mentionables!==this.props.mentionables&&this.onEditorContentChange(e),this.props.initMention&&!t.initMention){let t;let i=e;t=i.getSelection().size>0?h.Modifier.replaceText(i.getCurrentContent(),i.getSelection(),"@"):h.Modifier.insertText(i.getCurrentContent(),i.getSelection(),"@"),this.setState({editorState:h.EditorState.push(e,t,"insert-fragment")})}if(!t.typeahead&&this.props.typeahead&&"mentions"===this.props.typeahead.type){let{search:t}=(0,P.TE)(e);""===t&&this.state.contactsAnalytics?.trackQueryResult("",this.props.typeahead.mentions.length),this.props.dispatch(y.Qe())}}componentWillUnmount(){this.props.setIsEditorFocused(!1);let t=this.props.pendingUserInvites&&this.props.pendingUserInvites.length>0;t&&!this.props.hasMentionedPendingUserInvite?(this.props.dispatch(f.b({has_mentioned_pending_user_invite:!0})),this.props.setPendingUserInvitesAtom?.([])):t&&this.props.hasMentionedPendingUserInvite&&!this.props.hasMentionedPendingUserInviteTwice&&this.props.dispatch(f.b({has_mentioned_pending_user_invite_twice:!0}))}editHyperlinkFromTooltip(t,e){let i=this.state.editorState.getCurrentContent(),s="",n=0,o=0;if(i.getBlockMap().every((e,i)=>(e&&e.findEntityRanges(e=>e.getEntity()===t,(t,e)=>{s=i||"",n=t,o=e}),!s)),this.props.dispatch(S.jD()),""===s)return;let r=this.state.editorState.getSelection().merge({anchorKey:s,focusKey:s,anchorOffset:n,focusOffset:o});r=(0,P.Qo)(this.state.editorState,r,t);let a=h.EditorState.forceSelection(this.state.editorState,r);this.onChange(a),e&&this.setHyperlinkEditorState(a,e,t)}setHyperlinkEditorState(t,e,i){if(this.props.setHyperlinkLocation&&this.props.setHyperlinkEditorRef&&this.props.editorRef){this.setState({hyperlinkState:{selectionToHyperlink:t.getSelection(),entityKey:i}}),this.props.setHyperlinkLocation(e),this.props.setHyperlinkEditorRef(this.props.editorRef);let s=h.Modifier.applyInlineStyle(t.getCurrentContent(),t.getSelection(),"HIGHLIGHT"),n=h.EditorState.push(t,s,"change-inline-style");this.onChange(n)}}render(){let t=_.DX;t=this.props.className?t+" "+this.props.className:t+" "+_.DL;let e=(0,P.FA)(this.state.editorState);return(0,s.jsx)("div",{className:t,onMouseDown:(0,a.k)().a11y_new_comments_to_fpl?void 0:this.onMouseDown,onPointerDown:(0,a.k)().a11y_new_comments_to_fpl?this.onMouseDown:void 0,onContextMenu:this.onContextMenu,onFocus:this.onFocus,onClick:this.onFocus,"data-testid":"editable-typeahead",ref:this.wrapperRef,children:(0,s.jsx)(h.Editor,{"aria-haspopup":"listbox",ariaActiveDescendantID:this.props.typeahead?.type==="mentions"?this.props.activeMentionsId:void 0,ariaControls:this.props.typeahead?.type==="mentions"?k.Qd:void 0,ariaDescribedBy:"",ariaExpanded:this.props.typeahead?.type==="mentions",ariaLabel:this.props.ariaLabel??this.props.placeholderText,customStyleMap:L,editorState:this.state.editorState,handleBeforeInput:this._handleBeforeInput,handleKeyCommand:this.handleKeyCommand,handlePastedFiles:this.handlePastedFiles,handlePastedText:this.handlePastedText,handleReturn:this.handleReturn,keyBindingFn:this.keyBindingFn,onBlur:this.onBlur,onChange:this.onChange,placeholder:e?this.props.placeholderText:void 0,readOnly:this.props.readOnly,role:"combobox",spellCheck:!0,tabIndex:this.props.tabIndex||0})})}}j.displayName="EditableTypeahead"}}]);

//# debugId=11b66d40-149a-5408-9398-d72cfa234a26

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/f8cb3add858814296f838e3052ad1658bcd455b7/1861-3d9990e3d0b56944.min.js.map